<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 70kg</title><meta name="description" content="A Blog Powered By Hexo"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="70kg"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/应聘Android开发工程师_王鹏.pdf" target="_self" class="nav-list-link">RESUME</a></li><li class="nav-list-item"><a href="/book/" target="_self" class="nav-list-link">BOOKS</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><ul class="home post-list"><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/05/08/Instant-Run与Tinker中Application替换/" class="post-title-link">Instant-Run与Tinker中Application替换</a></h2><div class="post-info">May 8, 2017</div><div class="post-content"><ul>
<li>为什么要替换application</li>
</ul>
<p>因为5.0以下开始只会去加载第一个dex,如果appliaction不在第一个dex,则无法启动。如果把自己的appliaction放在第一个dex中，而自己的application没有使用multidex,则只会去加载原始加载生成的dex,也是会报错。所以办法就是去代理掉原始的application，将app启动的application设置为这个代理的application，在这个代理的application中可以确保使用multidex功能。</p>
<p>还有因为补丁是在appliaction中加载，这样会导致无法对appliaction的修复，还有因为 Android N 的混合编译的影响 ，Tinker 使用了类似 Instant-run 中 IncrementalClassLoader （具体实现过程还是有差距），新建一个classLoader，去 “替换”掉原始的 PathClassLoader 去加载所有dex。这些都需要在appliaction中进行修改。<br></div><a href="/2017/05/08/Instant-Run与Tinker中Application替换/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/03/02/搭建简易web微博/" class="post-title-link">Express + React 搭建简易web微博</a></h2><div class="post-info">Mar 2, 2017</div><div class="post-content"><p>最近用 React 写了个简单的web微博，因为js的跨域问题，无法直接请求web Weibo的API，所以只能使用Node来中转一下，这样玩法也更丰富，随便处理数据。目前的功能只包括看微博和查看大图。</div><a href="/2017/03/02/搭建简易web微博/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2016/12/31/《深入理解Java虚拟机》笔记/" class="post-title-link">《深入理解Java虚拟机》笔记</a></h2><div class="post-info">Dec 31, 2016</div><div class="post-content"><h2 id="自动内存管理机制"><a href="#自动内存管理机制" class="headerlink" title="自动内存管理机制"></a>自动内存管理机制</h2><h4 id="程序计数器"><a href="#程序计数器" class="headerlink" title="程序计数器"></a>程序计数器</h4><ul>
<li>通过改变这个计数器的指决定执行的下一条指令</li>
<li>线程私有 每条线程独立</li>
<li>不会 oom</div><a href="/2016/12/31/《深入理解Java虚拟机》笔记/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2016/12/25/Redux-2/" class="post-title-link">从零撸一个Redux</a></h2><div class="post-info">Dec 25, 2016</div><div class="post-content"><h4 id="扯一扯"><a href="#扯一扯" class="headerlink" title="扯一扯"></a>扯一扯</h4><p>这段时间在看 <code>Redux</code> 的东西，稍微梳理一下整个框架的流程。其实整个 <code>Redux</code> 的代码很少，现在我也不能理解很多它的思想，反正先撸出个简单的 <code>Redux</code> 吧。目标是照着它的流程写一个最简单的，也要支持异步 <code>Action</code>。也算是个笔记性的东西。</div><a href="/2016/12/25/Redux-2/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2016/12/15/Promise的使用/" class="post-title-link">Asncy await Promise的使用</a></h2><div class="post-info">Dec 15, 2016</div><div class="post-content"><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> fetch = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">            <span class="comment">// resolve('success');</span></div><div class="line">            reject(<span class="string">'error'</span>);</div><div class="line">        &#125;, <span class="number">2000</span>);</div><div class="line">    &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> testAsync = <span class="keyword">async</span>() =&gt; &#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">         <span class="keyword">return</span> <span class="keyword">await</span> fetch();</div><div class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">testAsync().then(<span class="function">(<span class="params">result</span>)=&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'这是成功的---&gt;'</span> + result);</div><div class="line">&#125;).catch(<span class="function">(<span class="params">error</span>)=&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'这是失败的---&gt;'</span> + error);</div><div class="line">&#125;);;</div></pre></td></tr></table></figure>
<p><code>async</code>函数返回的一个 <code>Promise</code>， 调用耗时函数前面加 <code>await</code> 关键字，返回成功的值，可以使用 <code>try..catch</code> 来进行捕获错误。上面的代码可以模拟一次请求的过程，最基本用法差不多都包括了</div><a href="/2016/12/15/Promise的使用/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2016/12/05/Redux-1/" class="post-title-link">简单谈谈Redux在项目中的使用</a></h2><div class="post-info">Dec 5, 2016</div><div class="post-content"><h1 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a>Reducer</h1><p><code>Reducer</code> :为了描述 <code>action</code> 如何改变 <code>state tree</code>。 输入 <code>action</code> 和 <code>state</code>，一般根据 <code>action</code> 的 <code>type</code> 进行区分，然后处理，改变 <code>state tree</code>。</div><a href="/2016/12/05/Redux-1/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2016/11/16/Router设计/" class="post-title-link">Router设计</a></h2><div class="post-info">Nov 16, 2016</div><div class="post-content"><p>&emsp;&emsp;最近公司的项目要进行页面间跳转的重构，首先项目是单 <code>Activity</code> + 多 <code>Fragment</code> 的结构，因为是电商的项目，所以涉及到很多 H5 , <code>Native</code> 和 <code>React Native</code> 页面之间的交互与跳转，这篇不是介绍两者之间是如何进行通信的，而是当 H5 或者外部分享的链接打开后传递过来 <code>Uri</code> 要解析跳转到 <code>Native</code> 的页面的处理。当然各个页面的 <code>Host</code>  是提前统一定义好的，具体的做法这里也不说了，也没什么难点。原来的写法是都放到一个 <code>Util</code> 类里面，各种 <code>Switch</code> <code>Case</code> 来进行分支判断，当项目越来越大维护起来十分的困难，而且本身 <code>Native</code> 的页面之间还有一套跳转的逻辑，同时维护两套的代价是很大的，所有希望将项目重构一下，统一两端的处理逻辑，就产生了下面的这个路由结构。</div><a href="/2016/11/16/Router设计/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2016/09/30/Redux/" class="post-title-link">React Native + Redux + React-Redux</a></h2><div class="post-info">Sep 30, 2016</div><div class="post-content"><p>在<code>Component</code>中的<code>state</code>相当于组件内的本地变量，用于储存view的本地变化</p>
<p><code>props</code>中存储数据， <code>props</code>属于readOnly的常量dic</div><a href="/2016/09/30/Redux/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2016/08/17/Refrofit源码浅析/" class="post-title-link">Retrofit源码浅析</a></h2><div class="post-info">Aug 17, 2016</div><div class="post-content"><p> 这篇主要会走读一下<code>Retrofit</code>的源码，解析一下里面遇到的一些设计模式，网络请求的过程等。</p>
<h3 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h3><p>从创建<code>Retrofit</code>开始，看一下常见的创建<code>Retrofit</code>的实例的方式<br></div><a href="/2016/08/17/Refrofit源码浅析/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2016/08/01/浅谈CoordinatorLayout/" class="post-title-link">浅谈CoordinatorLayout</a></h2><div class="post-info">Aug 1, 2016</div><div class="post-content"><h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>最近这一周空余的时间比较多，然后去重构了一个公司项目里的一个个人中心的页面，原来使用了<code>ListView</code>再加上<code>addHead</code>的方式，然后动态的去控制<code>Head</code>的高度去实现嵌套滑动的效果，因为我的模拟器没有跑起来，所以也没有去录下个GIF来，因为这篇主要说一下<code>CoordinatorLayout</code>的处理嵌套滑动的原理，没有效果图也影响不大。</div><a href="/2016/08/01/浅谈CoordinatorLayout/" class="read-more">...more</a></article></li></ul></main><footer><div class="paginator"><a href="/" class="prev">PREV</a><a href="/page/3/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2017 <a href="http://yoursite.com">70kg</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-81769413-1",'auto');ga('send','pageview');</script></body></html>